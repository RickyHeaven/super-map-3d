define(["./defaultValue-a9572088","./Ellipsoid-a181f4f7","./Rectangle-15196776","./arrayFill-69e0407a","./buildModuleUrl-0b6ed7f4","./Cartesian3-9e1fac2b","./Cartographic-832093e6","./ComponentDatatype-00a8741a","./Check-1ab97039","./GeometryAttribute-96eb6e6a","./GeometryAttributes-ba165842","./GeometryOffsetAttribute-b4d599f5","./IndexDatatype-42a29532","./Math-42d8c121","./PolygonPipeline-2e7b86a0","./PrimitiveType-56cd8f05","./RectangleGeometryLibrary-f93683d0","./FeatureDetection-b832308f","./defer-027bcf35","./Event-086a9f30","./RuntimeError-7a3815c0","./WebGLConstants-ade65f0f","./Cartesian4-c70aabd2","./EllipsoidRhumbLine-07313960"],(function(e,t,i,a,r,n,o,s,u,l,c,h,p,f,d,g,_,b,v,y,m,w,A,E){"use strict";var x=new r.i,D=new r.i,P=new n.o,H=new i.h;function k(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,u=a,h=2,f=0,d=4;n&&(h-=1,u-=1,f+=1,d-=2),o&&(h-=1,u-=1,f+=1,d-=2),f+=h*r+2*u-d;var b,v=new Float64Array(3*f),y=0,m=0,w=P;if(n)_.j.computePosition(t,i,!1,m,0,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;else for(b=0;b<r;b++)_.j.computePosition(t,i,!1,m,b,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(b=r-1,m=1;m<a;m++)_.j.computePosition(t,i,!1,m,b,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;if(m=a-1,!o)for(b=r-2;b>=0;b--)_.j.computePosition(t,i,!1,m,b,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(b=0,m=a-2;m>0;m--)_.j.computePosition(t,i,!1,m,b,w),v[y++]=w.x,v[y++]=w.y,v[y++]=w.z;for(var A=v.length/3*2,E=p.IndexDatatype.createTypedArray(v.length/3,A),x=0,D=0;D<v.length/3-1;D++)E[x++]=D,E[x++]=D+1;E[x++]=v.length/3-1,E[x++]=0;var H=new l.I({attributes:new c.a,primitiveType:g._0x4e53a2.LINES});return H.attributes.position=new l.o({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v}),H.indices=E,H}function L(a){var r=(a=e.u(a,e.u.EMPTY_OBJECT)).rectangle,n=e.u(a.granularity,f.e.RADIANS_PER_DEGREE),o=e.u(a.ellipsoid,t.t.WGS84),s=e.u(a.rotation,0);if(!e.e(r))throw new u.t("rectangle is required.");if(i.h.validate(r),r.north<r.south)throw new u.t("options.rectangle.north must be greater than options.rectangle.south");var l=e.u(a.height,0),c=e.u(a.extrudedHeight,l);this._rectangle=i.h.clone(r),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(l,c),this._rotation=s,this._extrudedHeight=Math.min(l,c),this._offsetAttribute=a.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}L.packedLength=i.h.packedLength+t.t.packedLength+5,L.pack=function(a,r,n){if(!e.e(a))throw new u.t("value is required");if(!e.e(r))throw new u.t("array is required");return n=e.u(n,0),i.h.pack(a._rectangle,r,n),n+=i.h.packedLength,t.t.pack(a._ellipsoid,r,n),n+=t.t.packedLength,r[n++]=a._granularity,r[n++]=a._surfaceHeight,r[n++]=a._rotation,r[n++]=a._extrudedHeight,r[n]=e.u(a._offsetAttribute,-1),r};var N=new i.h,G=t.t.clone(t.t.UNIT_SPHERE),C={rectangle:N,ellipsoid:G,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};L.unpack=function(a,r,n){if(!e.e(a))throw new u.t("array is required");r=e.u(r,0);var o=i.h.unpack(a,r,N);r+=i.h.packedLength;var s=t.t.unpack(a,r,G);r+=t.t.packedLength;var l=a[r++],c=a[r++],h=a[r++],p=a[r++],f=a[r];return e.e(n)?(n._rectangle=i.h.clone(o,n._rectangle),n._ellipsoid=t.t.clone(s,n._ellipsoid),n._surfaceHeight=c,n._rotation=h,n._extrudedHeight=p,n._offsetAttribute=-1===f?void 0:f,n):(C.granularity=l,C.height=c,C.rotation=h,C.extrudedHeight=p,C.offsetAttribute=-1===f?void 0:f,new L(C))};var I=new o.a;return L.createGeometry=function(t){var i,n,o=t._rectangle,u=t._ellipsoid,c=_.j.computeOptions(o,t._granularity,t._rotation,0,H,I);if(!f.e.equalsEpsilon(o.north,o.south,f.e.EPSILON10)&&!f.e.equalsEpsilon(o.east,o.west,f.e.EPSILON10)){var b,v=t._surfaceHeight,y=t._extrudedHeight;if(!f.e.equalsEpsilon(v,y,0,f.e.EPSILON2)){if(i=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,s=k(e,t),u=t.height,l=t.width,c=d.A.scaleToGeodeticHeight(s.attributes.position.values,o,r,!1),h=c.length,f=new Float64Array(2*h);f.set(c);var g=d.A.scaleToGeodeticHeight(s.attributes.position.values,n,r);f.set(g,h),s.attributes.position.values=f;var _=t.northCap,b=t.southCap,v=4;_&&(v-=1),b&&(v-=1);var y,m=2*(f.length/3+v),w=p.IndexDatatype.createTypedArray(f.length/3,m);h=f.length/6;for(var A=0,E=0;E<h-1;E++)w[A++]=E,w[A++]=E+1,w[A++]=E+h,w[A++]=E+h+1;if(w[A++]=h-1,w[A++]=0,w[A++]=h+h-1,w[A++]=h,w[A++]=0,w[A++]=h,_)y=u-1;else{var x=l-1;w[A++]=x,w[A++]=x+h,y=l+u-2}if(w[A++]=y,w[A++]=y+h,!b){var D=l+y-1;w[A++]=D,w[A]=D+h}return s.indices=w,s}(t,c),e.e(t._offsetAttribute)){var m=i.attributes.position.values.length/3,w=new Uint8Array(m);t._offsetAttribute===h.z.TOP?w=a.d(w,1,0,m/2):(b=t._offsetAttribute===h.z.NONE?0:1,w=a.d(w,b)),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var A=r.i.fromRectangle3D(o,u,v,D),E=r.i.fromRectangle3D(o,u,y,x);n=r.i.union(A,E)}else{if((i=k(t,c)).attributes.position.values=d.A.scaleToGeodeticHeight(i.attributes.position.values,v,u,!1),e.e(t._offsetAttribute)){var P=i.attributes.position.values.length,L=new Uint8Array(P/3);b=t._offsetAttribute===h.z.NONE?0:1,a.d(L,b),i.attributes.applyOffset=new l.o({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}n=r.i.fromRectangle3D(o,u,v)}return new l.I({attributes:i.attributes,indices:i.indices,primitiveType:g._0x4e53a2.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(a,r){return e.e(r)&&(a=L.unpack(a,r)),a._ellipsoid=t.t.clone(a._ellipsoid),a._rectangle=i.h.clone(a._rectangle),L.createGeometry(a)}}));
